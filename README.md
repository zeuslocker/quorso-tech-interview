# Description

You are running a chain of coffeeshops and want to have a service which would ingest their raw transactional data into an unified format in order to be able to analyse it. Unfortunately, these coffeeshops use slightly different formats to persist their data, so it's required to bring it in sync within the app. See source files in `support` folder.

You are free in choice of architecture to achieve goals outlined in tasks below. Any present codebase should be considered as hints. You can build your solution on top of it or remove entirely and propose your own approach, up to you - it's your call!

All names are fictional, any resemblance is purely coincidental.

## Shop identifiers
Each coffeeshop is referred by its identifier in the raw data, so `Coffeeshop A` has identifier `Location1` and `Coffeeshop B` has identifier `Location2`.

## Employees
Employees are referred by their respective identifiers where mentioned.

## Coffees sold
Your chain sells 5 flavours of coffee:
```
Espresso
Cappuccino
Flat White
Americano
Caffé Mocha
```

### Coffee identifiers
`Coffeeshop A` coffees are referred by these identifiers in sources (in the same order as coffees above):
```
C01
C02
C03
C04
C05
```

`Coffeeshop B` coffees are referred by these identifiers in sources (in the same order as coffees above):
```
ESP
CAP
FTW
AME
CMO
```

## Sources
You can find described source files in `support` folder.

### Employees source
This file contains information about employees of your coffeeshops and has next columns:
- coffeeshop identifier
- employee identifier
- employee name

### Transactions source
This file contains information about coffees sold by each employee and has next columns:
- coffeeshop identifier
- employee identifier
- coffee identifier
- price for transaction
- timestamp of transaction

It is understood that within each transaction only one coffee is sold.

# Your tasks
## Preparing for tasks
Bring up database, run provided migrations and seeds.

## Ruby tasks
### Task 1

Complete a rake task `import:employees`, which would import data into `employees` table. You need to bring in employees including their identifiers. Coffeeshops are refered by their respective identifiers in source file.

### Task 2

Complete a rake task `import:transactions`, which would import data into `transactions` table.

Resulting data in the table would look similarly to this:

| id | coffeeshop_id  | employee_id | coffee_id | price | sold_at          |
| -- | -------------- | ----------- | --------- | ----- | ---------------- |
| 1  | 1              | 2           | 1         | 1.00  | 2018-11-26 10:14 |
| 2  | 2              | 1           | 2         | 1.10  | 2018-11-26 11:11 |
| 3  | 2              | 3           | 3         | 1.20  | 2018-11-26 12:12 |
| 4  | 1              | 2           | 4         | 1.30  | 2018-11-26 13:13 |
| 5  | 2              | 1           | 5         | 1.40  | 2018-11-26 14:14 |
| 6  | 2              | 3           | 1         | 1.50  | 2018-11-26 15:15 |

## SQL
Put your queries in the root folder in files with names `task1.sql` and `task2.sql`.

### Task 1

Create an SQL query that will pull information about total revenue per week generated by all your employees.

Sample output should look like this (first row is correct for your reference):

| Week                    | Revenue (total £ for coffees sold) |
| ----------------------- | ---------------------------------- |
| 2018-12-03 - 2018-12-09 |                           37530.90 |
| 2018-12-10 - 2018-12-16 |                     [actual_value] |
| 2018-12-17 - 2018-12-23 |                     [actual_value] |
| 2018-12-24 - 2018-12-30 |                     [actual_value] |

### Task 2

Create an SQL query that will pull information on who has delivered biggest revenue for your chain for each individual week.

Sample output should look like this (first row is correct for your reference):

| Week                    | Coffeeshop     | Employee        | Revenue (total £ for coffees sold) |
| ----------------------- | -------------- | --------------- | ---------------------------------- |
| 2018-12-03 - 2018-12-09 | Coffeeshop B   | John Smith      |                            6465.35 |
| 2018-12-10 - 2018-12-16 | [actual_value] | [actual_value]  |                     [actual_value] |
| 2018-12-17 - 2018-12-23 | [actual_value] | [actual_value]  |                     [actual_value] |
| 2018-12-24 - 2018-12-30 | [actual_value] | [actual_value]  |                     [actual_value] |
